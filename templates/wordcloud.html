<html>
  <head>
    <title>Demo</title>
  </head>
  
  <body>
    <div id="plot"></div>
    <div id="app"></div>
    </div>
  </body>

  <!-- import Vue.js -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
  <!-- import d3.js -->
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <!-- import d3-cloud -->
  <script src="https://cdn.jsdelivr.net/gh/holtzy/D3-graph-gallery@master/LIB/d3.layout.cloud.js"></script>
  <script>
    const plot = {{ plot|tojson }}

    var app = new Vue({
      el: '#app',
      delimiters: ['[[', ']]'],
      data() {
        return {
          plot,
        }
      },

      mounted() {
        this.draw()
      },

      methods: {
        draw() {
          const data = this.plot[0]
          // set the dimensions and margins of the graph
          const margin = { top: 20, right: 20, bottom: 20, left: 20 },
              width = 1200 - margin.left - margin.right,
              height = 1200 - margin.top - margin.bottom;

          // append the svg object to the body of the page
          const svg = d3.select("#plot").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform",
                  "translate(" + margin.left + "," + margin.top + ")");

          // Constructs a new cloud layout instance. It run an algorithm to find the position of words that suits your requirements
          // Wordcloud features that are different from one word to the other must be here
          const layout = d3.layout.cloud()
            .size([width, height])
            .words(data.map(function(d) { return {text: d.word, size:d.size}; }))
            .padding(5)        //space between words
            .rotate(function() { return 0; })
            .fontSize(function(d) { return d.size; })      // font size of words
            .on("end", draws);
          layout.start();

          // This function takes the output of 'layout' above and draw the words
          // Wordcloud features that are THE SAME from one word to the other can be here
          function draws(words) {
            svg.append("g")
              .attr("transform", "translate(" + layout.size()[0] / 2 + "," + layout.size()[1] / 2 + ")")
              .selectAll("text")
              .data(words)
              .enter().append("text")
              .style("font-size", function(d) { return d.size; })
              .style("fill", "#69b3a2")
              .attr("text-anchor", "middle")
              .style("font-family", "Impact")
              .attr("transform", function(d) {
                return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
              })
              .text(function(d) { return d.text; });
          }
        },
      },
    });
  </script>
</html>